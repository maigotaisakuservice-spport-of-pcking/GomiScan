<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>AIごみ判別</title>
  <script src="https://cdn.jsdelivr.net/npm/onsenui/js/onsenui.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/onsenui/js/onsenui.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/firebase@9.6.1/firebase-app-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/firebase@9.6.1/firebase-firestore-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/onsenui/css/onsenui.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/onsenui/css/onsen-css-components.min.css" />
  <style>body { font-family: sans-serif; }</style>
</head>
<body>
<ons-navigator id="appNavigator" page="login.html"></ons-navigator>

<template id="login.html">
  <ons-page>
    <ons-toolbar><div class="center">ログイン</div></ons-toolbar>
    <ons-card>
      <ons-input id="tenantCode" modifier="underbar" placeholder="テナントPIN (5桁)" maxlength="5"></ons-input>
      <ons-button onclick="loginTenant()">次へ</ons-button>
      <p id="loginError" style="color:red;"></p>
      <ons-button onclick="document.querySelector('#appNavigator').pushPage('register.html')">新規登録</ons-button>
    </ons-card>
  </ons-page>
</template>

<template id="auth.html">
  <ons-page>
    <ons-toolbar><div class="center">テナント認証</div></ons-toolbar>
    <ons-card>
      <h3 id="tenantNameView">テナント名</h3>
      <ons-input id="tenantPassword" type="password" modifier="underbar" placeholder="パスワード"></ons-input>
      <ons-button onclick="verifyTenantPassword()">ログイン</ons-button>
      <p id="authError" style="color:red;"></p>
    </ons-card>
  </ons-page>
</template>

<template id="main.html">
  <ons-page>
    <ons-toolbar>
      <div class="center" id="tenantTitle">ごみAI</div>
      <div class="right"><ons-button modifier="quiet" onclick="logout()">⏻</ons-button></div>
    </ons-toolbar>
    <ons-card>
      <input type="file" id="imageInput" accept="image/*" onchange="analyzeImage()" />
      <p id="scanResult">画像を選択してください</p>
      <ons-button onclick="sendTeamsMessage()">Teams通知テスト</ons-button>
    </ons-card>
    <ons-button onclick="document.querySelector('#appNavigator').pushPage('manage.html')">▶ テナント管理</ons-button>
  </ons-page>
</template>

<template id="register.html">
  <ons-page>
    <ons-toolbar><div class="center">新規登録</div></ons-toolbar>
    <ons-card>
      <ons-input id="regTenantName" modifier="underbar" placeholder="テナント名"></ons-input>
      <ons-input id="regPin" modifier="underbar" placeholder="PIN (5桁)" maxlength="5"></ons-input>
      <ons-input id="regPassword" type="password" modifier="underbar" placeholder="パスワード"></ons-input>
      <ons-input id="regContact" modifier="underbar" placeholder="連絡先（任意）"></ons-input>
      <ons-input id="regWebhook" modifier="underbar" placeholder="Teams Webhook URL（任意）"></ons-input>
      <ons-checkbox id="regIsEnterprise"></ons-checkbox>エンタープライズモード<br>
      <ons-button onclick="registerTenant()">登録</ons-button>
      <p id="registerError" style="color:red;"></p>
    </ons-card>
  </ons-page>
</template>

<template id="manage.html">
  <ons-page>
    <ons-toolbar><div class="center">管理ページ</div></ons-toolbar>
    <ons-card>
      <ons-button onclick="addCustomDay()">📆 カスタム曜日追加</ons-button>
    </ons-card>
  </ons-page>
</template>

<script src="enterprise.js"></script>
</body>
</html>
